# ç™ºæ³¨ç®¡ç†æ©Ÿèƒ½çµ±åˆ å®Ÿè£…ãƒ—ãƒ©ãƒ³

æœ€çµ‚æ›´æ–°: 2025-11-02

## ğŸ“‹ æ¦‚è¦

æœ¬ãƒ—ãƒ©ãƒ³ã¯ã€æ—¢å­˜ã®å£²ä¸Šãƒ»åœ¨åº«ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã«ç™ºæ³¨ç®¡ç†æ©Ÿèƒ½ã‚’çµ±åˆã™ã‚‹ãŸã‚ã®æ®µéšçš„å®Ÿè£…è¨ˆç”»ã§ã™ã€‚
10ãƒ•ã‚§ãƒ¼ã‚ºã«åˆ†å‰²ã—ã€å„ãƒ•ã‚§ãƒ¼ã‚ºã§å‹•ä½œç¢ºèªã‚’è¡Œã„ãªãŒã‚‰ç¢ºå®Ÿã«é€²ã‚ã¾ã™ã€‚

**å‰ææ¡ä»¶**:
âœ… ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆæ§‹é€ ã®æ•´å‚™å®Œäº†
- å•†å“ãƒã‚¹ã‚¿ã«ã€Œãƒ–ãƒ©ãƒ³ãƒ‰ã€åˆ—ã‚’è¿½åŠ æ¸ˆã¿
- ä»•å…¥ã‚Œãƒã‚¹ã‚¿ã‚·ãƒ¼ãƒˆä½œæˆæ¸ˆã¿
- ç™ºæ³¨ç®¡ç†ã‚·ãƒ¼ãƒˆä½œæˆæ¸ˆã¿

---

## ğŸ¯ å…¨ä½“ç›®æ¨™

1. **GASå´**: æ›¸è¾¼æ©Ÿèƒ½ã‚’è¿½åŠ ã—ã€ç™ºæ³¨CRUD + ãƒ¡ãƒ¼ãƒ«é€ä¿¡APIã‚’å®Ÿè£…
2. **Next.jså´**: RESTful ãªãƒ—ãƒ­ã‚­ã‚·ãƒ«ãƒ¼ãƒˆã‚’è¿½åŠ 
3. **UIå´**: `/orders` ã‚¿ãƒ–ã‚’è¿½åŠ ã—ã€ä¸€è¦§ãƒ»ä½œæˆãƒ»ç·¨é›†æ©Ÿèƒ½ã‚’æä¾›
4. **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**: æ—¢å­˜ã®èªè¨¼æ–¹å¼ï¼ˆGoogle OAuth + allowlistï¼‰ã‚’ç¶­æŒ
5. **ä¸€è²«æ€§**: æ—¢å­˜UIã¨ã®æ•´åˆæ€§ã‚’ä¿ã¡ã€shadcn/ui ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å†åˆ©ç”¨

---

## ğŸ“ å®Ÿè£…ãƒ•ã‚§ãƒ¼ã‚ºä¸€è¦§

```
Phase 1  â”â”â” GASåŸºç›¤æ•´å‚™ï¼ˆæ›¸è¾¼æ¨©é™ãƒ»doPostãƒ»ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£æ‹¡å¼µï¼‰
Phase 2  â”â”â” GASç™ºæ³¨CRUD APIï¼ˆä½œæˆãƒ»å–å¾—ãƒ»æ›´æ–°ãƒ»ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹é·ç§»ï¼‰
Phase 3  â”â”â” GASãƒ¡ãƒ¼ãƒ«é€ä¿¡APIï¼ˆä¾é ¼ãƒ¡ãƒ¼ãƒ«ãƒ»ç´å“å®Œäº†ãƒ¡ãƒ¼ãƒ«ï¼‰
Phase 4  â”â”â” GASãƒã‚¹ã‚¿æ¤œç´¢APIæ‹¡å¼µï¼ˆä»•å…¥ã‚Œãƒã‚¹ã‚¿çµåˆãƒ»å•†å“æ¤œç´¢ï¼‰
         â†“
Phase 5  â”â”â” Next.jsã‚µãƒ¼ãƒãƒ«ãƒ¼ãƒˆå®Ÿè£…ï¼ˆç™ºæ³¨APIç¾¤ã®ãƒ—ãƒ­ã‚­ã‚·ï¼‰
Phase 6  â”â”â” å‹å®šç¾©ã¨ã‚¹ã‚­ãƒ¼ãƒæ•´å‚™ï¼ˆTypeScript typesãƒ»ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰
         â†“
Phase 7  â”â”â” UIå®Ÿè£… - ç™ºæ³¨ä¸€è¦§ãƒšãƒ¼ã‚¸ï¼ˆ/ordersï¼‰
Phase 8  â”â”â” UIå®Ÿè£… - æ–°è¦ç™ºæ³¨ä½œæˆãƒšãƒ¼ã‚¸ï¼ˆ/orders/createï¼‰
Phase 9  â”â”â” UIå®Ÿè£… - ãƒã‚¹ã‚¿é–²è¦§ãƒšãƒ¼ã‚¸ï¼ˆ/mastersï¼‰
         â†“
Phase 10 â”â”â” çµ±åˆãƒ»ãƒ†ã‚¹ãƒˆãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤æº–å‚™
```

---

## Phase 1: GASåŸºç›¤æ•´å‚™ ğŸ”´ æœ€å„ªå…ˆ

**ç›®çš„**: GASã§æ›¸è¾¼å‡¦ç†ã‚’å¯èƒ½ã«ã—ã€POST/PUT/DELETEã«å¯¾å¿œã™ã‚‹åŸºç›¤ã‚’æ§‹ç¯‰

### ä½œæ¥­å†…å®¹

#### 1.1 ã‚¹ã‚³ãƒ¼ãƒ—å¤‰æ›´
**ãƒ•ã‚¡ã‚¤ãƒ«**: `apps/gas/src/appsscript.json`

```json
{
  "timeZone": "Asia/Tokyo",
  "exceptionLogging": "STACKDRIVER",
  "oauthScopes": [
    "https://www.googleapis.com/auth/spreadsheets",  // readonly â†’ èª­ã¿æ›¸ãå¯èƒ½ã«å¤‰æ›´
    "https://www.googleapis.com/auth/script.send_mail"  // ãƒ¡ãƒ¼ãƒ«é€ä¿¡ç”¨ã«è¿½åŠ 
  ],
  "runtimeVersion": "V8",
  "webapp": {
    "access": "ANYONE",
    "executeAs": "USER_DEPLOYING"
  }
}
```

#### 1.2 doPostå®Ÿè£…
**ãƒ•ã‚¡ã‚¤ãƒ«**: `apps/gas/src/Code.js`

```javascript
// æ—¢å­˜ã®doGet()ã«åŠ ãˆã¦è¿½åŠ 
function doPost(e) {
  try {
    guard_(e); // èªè¨¼ãƒã‚§ãƒƒã‚¯ï¼ˆæ—¢å­˜ï¼‰
    
    const payload = JSON.parse(e.postData.contents || '{}');
    const action = e.parameter.action;
    
    // ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
    if (action === 'createOrder') return handleCreateOrder_(payload);
    if (action === 'updateOrder') return handleUpdateOrder_(payload);
    if (action === 'changeStatus') return handleChangeStatus_(payload);
    if (action === 'sendRequestEmail') return handleSendRequestEmail_(payload);
    if (action === 'sendDeliveryEmail') return handleSendDeliveryEmail_(payload);
    
    return json_({ error: 'unknown action' }, 400);
  } catch (err) {
    Logger.log('doPost error: ' + err.toString());
    return json_({ error: String(err), stack: err.stack }, 500);
  }
}

// PUT/DELETEã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”¨
function doPut(e) { return doPost(e); }
function doDelete(e) { return doPost(e); }
```

#### 1.3 ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£æ‹¡å¼µ
**ãƒ•ã‚¡ã‚¤ãƒ«**: `apps/gas/src/util.js`

```javascript
// æ—¢å­˜ã®util.js ã«ä»¥ä¸‹ã‚’è¿½åŠ 

/**
 * æ—¥ä»˜æ–‡å­—åˆ—ã‚’Dateã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›
 * @param {string} str YYYY-MM-DDå½¢å¼
 * @return {Date|null}
 */
function parseDate_(str) {
  if (!str) return null;
  var match = String(str).match(/^(\d{4})-(\d{2})-(\d{2})/);
  if (!match) return null;
  return new Date(parseInt(match[1]), parseInt(match[2]) - 1, parseInt(match[3]));
}

/**
 * Dateã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’YYYY-MM-DDå½¢å¼ã«å¤‰æ›
 * @param {Date} date
 * @return {string}
 */
function formatDate_(date) {
  if (!date || !(date instanceof Date)) return '';
  return Utilities.formatDate(date, 'Asia/Tokyo', 'yyyy-MM-dd');
}

/**
 * Dateã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’YYYY-MM-DD HH:MM:SSå½¢å¼ã«å¤‰æ›
 * @param {Date} date
 * @return {string}
 */
function formatDateTime_(date) {
  if (!date || !(date instanceof Date)) return '';
  return Utilities.formatDate(date, 'Asia/Tokyo', 'yyyy-MM-dd HH:mm:ss');
}

/**
 * å››æ¨äº”å…¥
 * @param {number} value
 * @param {number} decimals å°æ•°ç‚¹ä»¥ä¸‹æ¡æ•°ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ0ï¼‰
 * @return {number}
 */
function round_(value, decimals) {
  decimals = decimals || 0;
  var factor = Math.pow(10, decimals);
  return Math.round(value * factor) / factor;
}
```

#### 1.4 è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
**ãƒ•ã‚¡ã‚¤ãƒ«**: `apps/gas/src/config.js`ï¼ˆæ–°è¦ï¼‰

```javascript
/**
 * ç™ºæ³¨ç®¡ç†ç”¨è¨­å®š
 */
var CONFIG = {
  // ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆIDï¼ˆç’°å¢ƒã«å¿œã˜ã¦å¤‰æ›´ï¼‰
  SPREADSHEET_ID: PropertiesService.getScriptProperties().getProperty('SPREADSHEET_ID') || 'YOUR_SHEET_ID',
  
  // ã‚·ãƒ¼ãƒˆå
  SHEETS: {
    ORDERS: 'ç™ºæ³¨ç®¡ç†',
    PRODUCT_MASTER: 'å•†å“ãƒã‚¹ã‚¿',
    PURCHASE_MASTER: 'ä»•å…¥ã‚Œãƒã‚¹ã‚¿',
    PRODUCT_STATE: 'å•†å“çŠ¶æ…‹',
    DAILY_SALES: 'æ—¥æ¬¡å£²ä¸Šé›†è¨ˆ',
    SKU_SALES_DAILY: 'å•†å“åˆ¥æ—¥æ¬¡å£²ä¸Šé›†è¨ˆ',
    BUYBOX_DAILY: 'å•†å“åˆ¥ã‚«ãƒ¼ãƒˆå–å¾—ç‡é›†è¨ˆ',
    STOCK_SKU_DAILY: 'å•†å“åˆ¥åœ¨åº«æ—¥æ¬¡é›†è¨ˆ',
    STOCK_GLOBAL_DAILY: 'å…¨ä½“åœ¨åº«æ—¥æ¬¡é›†è¨ˆ'
  },
  
  // ãƒ¡ãƒ¼ãƒ«è¨­å®š
  MAIL: {
    SUPROLE: PropertiesService.getScriptProperties().getProperty('MAIL_SUPROLE') || 'suprole@example.com',
    BEFREE: PropertiesService.getScriptProperties().getProperty('MAIL_BEFREE') || 'befree@example.com'
  },
  
  // ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³
  PAGINATION: {
    ITEMS_PER_PAGE: 50
  },
  
  // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹é·ç§»å®šç¾©
  STATUS_TRANSITIONS: {
    'sup_ä¾é ¼ä¸­': ['be_ãƒ¡ãƒ¼ã‚«ãƒ¼å–å¯„ä¸­', 'ä¿ç•™', 'è¿”å“'],
    'be_ãƒ¡ãƒ¼ã‚«ãƒ¼å–å¯„ä¸­': ['be_ç´å“æ‰‹ç¶šå®Œäº†', 'ä¿ç•™', 'è¿”å“'],
    'be_ç´å“æ‰‹ç¶šå®Œäº†': ['sup_å—å–å®Œäº†', 'ä¿ç•™', 'è¿”å“'],
    'sup_å—å–å®Œäº†': ['sup_fbaå‡ºè·å®Œäº†', 'ä¿ç•™', 'è¿”å“'],
    'sup_fbaå‡ºè·å®Œäº†': ['ä¿ç•™', 'è¿”å“'],
    'ä¿ç•™': ['ä¿ç•™', 'è¿”å“'],
    'è¿”å“': []
  }
};
```

### ãƒ†ã‚¹ãƒˆå†…å®¹
1. GASã‚¨ãƒ‡ã‚£ã‚¿ã§å†ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆæ¨©é™æ‰¿èªãŒå¿…è¦ï¼‰
2. doPost()ãŒå‘¼ã³å‡ºã›ã‚‹ã“ã¨ã‚’ç¢ºèª
3. Script Propertiesã«ä»¥ä¸‹ã‚’è¨­å®š:
   - `SPREADSHEET_ID`: å®Ÿéš›ã®ã‚·ãƒ¼ãƒˆID
   - `MAIL_SUPROLE`: é€ä¿¡å…ˆãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹
   - `MAIL_BEFREE`: é€ä¿¡å…ˆãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹

### å®Œäº†æ¡ä»¶
âœ… ã‚¹ã‚³ãƒ¼ãƒ—å¤‰æ›´ãŒåæ˜ ã•ã‚Œã€ã‚·ãƒ¼ãƒˆã¸ã®æ›¸è¾¼æ¨©é™ãŒä»˜ä¸ã•ã‚Œã¦ã„ã‚‹  
âœ… doPost()çµŒç”±ã§actionãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãŒå‹•ä½œã™ã‚‹  
âœ… æ–°ã—ã„ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°ãŒã‚¨ãƒ©ãƒ¼ãªãå®Ÿè¡Œã§ãã‚‹

---

## Phase 2: GASç™ºæ³¨CRUD APIå®Ÿè£… ğŸ”´ æœ€å„ªå…ˆ

**ç›®çš„**: ç™ºæ³¨ã®ä½œæˆãƒ»å–å¾—ãƒ»æ›´æ–°ãƒ»ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´ã®APIã‚’å®Ÿè£…

### ä½œæ¥­å†…å®¹

#### 2.1 ã‚·ãƒ¼ãƒˆãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£æ‹¡å¼µ
**ãƒ•ã‚¡ã‚¤ãƒ«**: `apps/gas/src/sheets.js`

```javascript
// æ—¢å­˜ã®sheets.jsã«ä»¥ä¸‹ã‚’è¿½åŠ 

/**
 * ç™ºæ³¨ç®¡ç†ã‚·ãƒ¼ãƒˆã‚’é–‹ã
 */
function openOrdersSheet_() {
  var ss = SpreadsheetApp.openById(CONFIG.SPREADSHEET_ID);
  var sheet = ss.getSheetByName(CONFIG.SHEETS.ORDERS);
  if (!sheet) throw new Error('ç™ºæ³¨ç®¡ç†ã‚·ãƒ¼ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: ' + CONFIG.SHEETS.ORDERS);
  return sheet;
}

/**
 * å•†å“ãƒã‚¹ã‚¿ã‚·ãƒ¼ãƒˆã‚’é–‹ã
 */
function openProductMasterSheet_() {
  var ss = SpreadsheetApp.openById(CONFIG.SPREADSHEET_ID);
  var sheet = ss.getSheetByName(CONFIG.SHEETS.PRODUCT_MASTER);
  if (!sheet) throw new Error('å•†å“ãƒã‚¹ã‚¿ã‚·ãƒ¼ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
  return sheet;
}

/**
 * ä»•å…¥ã‚Œãƒã‚¹ã‚¿ã‚·ãƒ¼ãƒˆã‚’é–‹ã
 */
function openPurchaseMasterSheet_() {
  var ss = SpreadsheetApp.openById(CONFIG.SPREADSHEET_ID);
  var sheet = ss.getSheetByName(CONFIG.SHEETS.PURCHASE_MASTER);
  if (!sheet) throw new Error('ä»•å…¥ã‚Œãƒã‚¹ã‚¿ã‚·ãƒ¼ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
  return sheet;
}

/**
 * ã‚·ãƒ¼ãƒˆã®å…¨ãƒ‡ãƒ¼ã‚¿ã‚’åˆ—åä»˜ãã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆé…åˆ—ã§å–å¾—
 * @param {Sheet} sheet
 * @return {Array<Object>}
 */
function readSheetAsObjects_(sheet) {
  var values = sheet.getDataRange().getValues();
  if (values.length === 0) return [];
  
  var headers = values[0];
  var data = [];
  
  for (var i = 1; i < values.length; i++) {
    var row = {};
    for (var j = 0; j < headers.length; j++) {
      row[String(headers[j])] = values[i][j];
    }
    data.push(row);
  }
  
  return data;
}
```

#### 2.2 ç™ºæ³¨IDç”Ÿæˆ
**ãƒ•ã‚¡ã‚¤ãƒ«**: `apps/gas/src/handlers/orders.js`ï¼ˆæ–°è¦ï¼‰

```javascript
/**
 * ç™ºæ³¨IDç”Ÿæˆï¼ˆPO-YYYYMMDD-NNNNå½¢å¼ï¼‰
 * @return {string}
 */
function generatePoId_() {
  var today = new Date();
  var dateStr = Utilities.formatDate(today, 'Asia/Tokyo', 'yyyyMMdd');
  var prefix = 'PO-' + dateStr + '-';
  
  var sheet = openOrdersSheet_();
  var data = readSheetAsObjects_(sheet);
  
  // ä»Šæ—¥ã®ç™ºæ³¨IDã‚’æŠ½å‡º
  var todayOrders = data.filter(function(row) {
    return String(row.po_id || '').indexOf(prefix) === 0;
  });
  
  // æœ€å¤§é€£ç•ªã‚’å–å¾—
  var maxSeq = 0;
  todayOrders.forEach(function(row) {
    var match = String(row.po_id).match(/-(\d{4})$/);
    if (match) {
      var seq = parseInt(match[1]);
      if (seq > maxSeq) maxSeq = seq;
    }
  });
  
  // æ¬¡ã®é€£ç•ª
  var nextSeq = maxSeq + 1;
  var seqStr = ('0000' + nextSeq).slice(-4);
  
  return prefix + seqStr;
}
```

#### 2.3 ç™ºæ³¨å–å¾—API
**ãƒ•ã‚¡ã‚¤ãƒ«**: `apps/gas/src/handlers/orders.js`

```javascript
/**
 * ç™ºæ³¨ä¸€è¦§å–å¾—ï¼ˆãƒ•ã‚£ãƒ«ã‚¿ãƒ»ã‚½ãƒ¼ãƒˆå¯¾å¿œï¼‰
 * @param {Object} filters
 * @return {Array<Object>}
 */
function getOrders_(filters) {
  filters = filters || {};
  
  var sheet = openOrdersSheet_();
  var orders = readSheetAsObjects_(sheet);
  
  // å•†å“ãƒã‚¹ã‚¿ã¨çµåˆï¼ˆå•†å“åã‚’ä»˜ä¸ï¼‰
  var productMap = getProductMasterMap_();
  
  orders = orders.map(function(order) {
    var sku = String(order.SKU || '');
    var product = productMap[sku] || {};
    
    return {
      po_id: String(order.po_id || ''),
      sku: sku,
      asin: String(order.ASIN || ''),
      productCode: String(order['å•†å“ã‚³ãƒ¼ãƒ‰'] || ''),
      productName: product.name || String(order['å•†å“å'] || ''),
      orderDate: formatDate_(order['ç™ºæ³¨æ—¥']),
      seller: String(order['ç™ºæ³¨å…ˆã‚»ãƒ©ãƒ¼'] || ''),
      quantity: num_(order['ç™ºæ³¨æ•°é‡ï¼ˆå€‹ï¼‰']),
      setCount: num_(order['ã‚»ãƒƒãƒˆæ•°']),
      setSize: num_(order['ã‚»ãƒƒãƒˆå€‹æ•°']),
      unitPrice: num_(order['å˜ä¾¡ï¼ˆç¨æŠœ/å€‹ï¼‰']),
      subtotal: num_(order['ç¨æŠœç´”å£²ä¸Šé«˜']),
      taxRate: num_(order['æ¶ˆè²»ç¨ç‡']),
      invoiceNo: String(order['ä¼ç¥¨No.'] || ''),
      arrivalDate: formatDate_(order['åˆ°ç€äºˆå®šæ—¥']),
      status: String(order['ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹'] || ''),
      remarks: String(order['å‚™è€ƒ'] || ''),
      createdBy: String(order.created_by || ''),
      createdAt: formatDateTime_(order.created_at),
      lastUpdatedBy: String(order.last_updated_by || ''),
      lastUpdatedAt: formatDateTime_(order.last_updated_at)
    };
  });
  
  // ãƒ•ã‚£ãƒ«ã‚¿é©ç”¨
  if (filters.po_id) {
    orders = orders.filter(function(o) { return o.po_id === filters.po_id; });
  }
  if (filters.statuses && filters.statuses.length > 0) {
    orders = orders.filter(function(o) { return filters.statuses.indexOf(o.status) >= 0; });
  }
  if (filters.sku) {
    orders = orders.filter(function(o) { return o.sku === filters.sku; });
  }
  if (filters.asin) {
    orders = orders.filter(function(o) { return o.asin === filters.asin; });
  }
  if (filters.seller) {
    orders = orders.filter(function(o) { return o.seller === filters.seller; });
  }
  if (filters.productName) {
    var keyword = String(filters.productName).toLowerCase();
    orders = orders.filter(function(o) { 
      return o.productName.toLowerCase().indexOf(keyword) >= 0; 
    });
  }
  if (filters.fromDate) {
    orders = orders.filter(function(o) { return o.orderDate >= filters.fromDate; });
  }
  if (filters.toDate) {
    orders = orders.filter(function(o) { return o.orderDate <= filters.toDate; });
  }
  
  // ã‚½ãƒ¼ãƒˆï¼ˆç™ºæ³¨æ—¥é™é †ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰
  orders.sort(function(a, b) {
    if (a.orderDate > b.orderDate) return -1;
    if (a.orderDate < b.orderDate) return 1;
    return 0;
  });
  
  return orders;
}

/**
 * å•†å“ãƒã‚¹ã‚¿ã‚’ãƒãƒƒãƒ—ã§å–å¾—
 */
function getProductMasterMap_() {
  var sheet = openProductMasterSheet_();
  var products = readSheetAsObjects_(sheet);
  var map = {};
  
  products.forEach(function(p) {
    var sku = String(p.SKU || '');
    map[sku] = {
      asin: String(p.ASIN || ''),
      productCode: String(p['å•†å“ã‚³ãƒ¼ãƒ‰'] || ''),
      name: String(p['å•†å“å'] || ''),
      brand: String(p['ãƒ–ãƒ©ãƒ³ãƒ‰'] || '')
    };
  });
  
  return map;
}

/**
 * ç™ºæ³¨è©³ç´°å–å¾—
 */
function getOrderById_(poId) {
  var orders = getOrders_({ po_id: poId });
  return orders.length > 0 ? orders[0] : null;
}

/**
 * GETãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒãƒ³ãƒ‰ãƒ©ï¼ˆç™ºæ³¨ä¸€è¦§ï¼‰
 */
function handleGetOrders_(e) {
  var p = e.parameter || {};
  var filters = {
    po_id: p.po_id,
    statuses: p.statuses ? String(p.statuses).split(',') : null,
    sku: p.sku,
    asin: p.asin,
    seller: p.seller,
    productName: p.productName,
    fromDate: p.fromDate,
    toDate: p.toDate
  };
  
  var orders = getOrders_(filters);
  
  return json_({ items: orders, total: orders.length });
}
```

#### 2.4 ç™ºæ³¨ä½œæˆAPI
**ãƒ•ã‚¡ã‚¤ãƒ«**: `apps/gas/src/handlers/orders.js`

```javascript
/**
 * ç™ºæ³¨ä½œæˆ
 * @param {Object} input
 * @return {Object}
 */
function createOrder_(input) {
  // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
  if (!input.sku) throw new Error('SKUã¯å¿…é ˆã§ã™');
  if (!input.setCount || input.setCount <= 0) throw new Error('ã‚»ãƒƒãƒˆæ•°ã¯1ä»¥ä¸Šã‚’æŒ‡å®šã—ã¦ãã ã•ã„');
  
  // å•†å“ãƒã‚¹ã‚¿ã‹ã‚‰æƒ…å ±å–å¾—
  var productMap = getProductMasterMap_();
  var product = productMap[input.sku];
  if (!product) throw new Error('å•†å“ãƒã‚¹ã‚¿ã«å­˜åœ¨ã—ãªã„SKUã§ã™: ' + input.sku);
  
  // ä»•å…¥ã‚Œãƒã‚¹ã‚¿ã‹ã‚‰æƒ…å ±å–å¾—
  var purchaseInfo = getPurchaseInfo_(product.asin);
  if (!purchaseInfo) throw new Error('ä»•å…¥ã‚Œãƒã‚¹ã‚¿ã«å­˜åœ¨ã—ãªã„ASINã§ã™: ' + product.asin);
  
  // æœ€å°ãƒ­ãƒƒãƒˆãƒã‚§ãƒƒã‚¯
  if (purchaseInfo.minLot > 0 && input.setCount % purchaseInfo.minLot !== 0) {
    throw new Error('ã‚»ãƒƒãƒˆæ•°ã¯æœ€å°ãƒ­ãƒƒãƒˆ(' + purchaseInfo.minLot + ')ã®å€æ•°ã§æŒ‡å®šã—ã¦ãã ã•ã„');
  }
  
  // è¨ˆç®—
  var setSize = purchaseInfo.setSize;
  var unitPrice = round_(purchaseInfo.purchasePrice / setSize, 2);
  var quantity = input.setCount * setSize;
  var subtotal = unitPrice * quantity;
  var taxRate = input.taxRate !== undefined ? input.taxRate : 0.1;
  
  // po_idç”Ÿæˆ
  var poId = generatePoId_();
  
  // ç™ºæ³¨ãƒ¬ã‚³ãƒ¼ãƒ‰ä½œæˆ
  var now = new Date();
  var orderDate = input.orderDate ? parseDate_(input.orderDate) : now;
  
  var orderRow = [
    poId,                           // po_id
    input.sku,                      // SKU
    product.asin,                   // ASIN
    product.productCode,            // å•†å“ã‚³ãƒ¼ãƒ‰
    product.name,                   // å•†å“å
    orderDate,                      // ç™ºæ³¨æ—¥
    input.seller || 'Suprole',     // ç™ºæ³¨å…ˆã‚»ãƒ©ãƒ¼
    quantity,                       // ç™ºæ³¨æ•°é‡ï¼ˆå€‹ï¼‰
    input.setCount,                 // ã‚»ãƒƒãƒˆæ•°
    setSize,                        // ã‚»ãƒƒãƒˆå€‹æ•°
    unitPrice,                      // å˜ä¾¡ï¼ˆç¨æŠœ/å€‹ï¼‰
    subtotal,                       // ç¨æŠœç´”å£²ä¸Šé«˜
    taxRate,                        // æ¶ˆè²»ç¨ç‡
    '',                             // ä¼ç¥¨No.
    null,                           // åˆ°ç€äºˆå®šæ—¥
    'sup_ä¾é ¼ä¸­',                   // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
    input.remarks || '',            // å‚™è€ƒ
    input.createdBy || '',          // created_by
    now,                            // created_at
    input.createdBy || '',          // last_updated_by
    now                             // last_updated_at
  ];
  
  // ã‚·ãƒ¼ãƒˆã«è¿½åŠ 
  var sheet = openOrdersSheet_();
  sheet.appendRow(orderRow);
  
  Logger.log('ç™ºæ³¨ä½œæˆæˆåŠŸ: ' + poId);
  
  return { success: true, po_id: poId };
}

/**
 * ä»•å…¥ã‚Œãƒã‚¹ã‚¿æƒ…å ±å–å¾—
 */
function getPurchaseInfo_(asin) {
  var sheet = openPurchaseMasterSheet_();
  var data = readSheetAsObjects_(sheet);
  
  for (var i = 0; i < data.length; i++) {
    if (String(data[i].ASIN) === asin) {
      return {
        setSize: num_(data[i]['ã‚»ãƒƒãƒˆå€‹æ•°']) || 1,
        minLot: num_(data[i]['æœ€å°ãƒ­ãƒƒãƒˆ']) || 1,
        purchasePrice: num_(data[i]['ä»•å…¥ã‚Œå€¤ï¼ˆç¨æŠœ/ã‚»ãƒƒãƒˆï¼‰']),
        hazard: data[i]['å±é™ºç‰©'] === true || data[i]['å±é™ºç‰©'] === 'TRUE',
        hasExpiry: data[i]['æ¶ˆè²»æœŸé™è¦'] === true || data[i]['æ¶ˆè²»æœŸé™è¦'] === 'TRUE'
      };
    }
  }
  
  return null;
}

/**
 * POSTãƒãƒ³ãƒ‰ãƒ©ï¼ˆç™ºæ³¨ä½œæˆï¼‰
 */
function handleCreateOrder_(payload) {
  return json_(createOrder_(payload));
}
```

#### 2.5 ç™ºæ³¨æ›´æ–°API
**ãƒ•ã‚¡ã‚¤ãƒ«**: `apps/gas/src/handlers/orders.js`

```javascript
/**
 * ç™ºæ³¨æ›´æ–°
 * @param {Object} payload
 */
function updateOrder_(payload) {
  if (!payload.po_id) throw new Error('po_idã¯å¿…é ˆã§ã™');
  
  var sheet = openOrdersSheet_();
  var data = sheet.getDataRange().getValues();
  var headers = data[0];
  
  // po_idã®åˆ—ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹å–å¾—
  var poIdColIndex = headers.indexOf('po_id');
  if (poIdColIndex === -1) throw new Error('po_idåˆ—ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
  
  // å¯¾è±¡è¡Œã‚’æ¤œç´¢
  var targetRowIndex = -1;
  for (var i = 1; i < data.length; i++) {
    if (String(data[i][poIdColIndex]) === payload.po_id) {
      targetRowIndex = i + 1; // ã‚·ãƒ¼ãƒˆä¸Šã®è¡Œç•ªå·ï¼ˆ1-indexedï¼‰
      break;
    }
  }
  
  if (targetRowIndex === -1) {
    throw new Error('ç™ºæ³¨ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: ' + payload.po_id);
  }
  
  // æ›´æ–°å¯èƒ½ãªé …ç›®
  var updates = {
    'æ¶ˆè²»ç¨ç‡': payload.taxRate !== undefined ? payload.taxRate : null,
    'ä¼ç¥¨No.': payload.invoiceNo !== undefined ? payload.invoiceNo : null,
    'åˆ°ç€äºˆå®šæ—¥': payload.arrivalDate ? parseDate_(payload.arrivalDate) : null,
    'å‚™è€ƒ': payload.remarks !== undefined ? payload.remarks : null
  };
  
  // ç›£æŸ»é …ç›®
  updates['last_updated_by'] = payload.updatedBy || '';
  updates['last_updated_at'] = new Date();
  
  // åˆ—ã”ã¨ã«æ›´æ–°
  for (var key in updates) {
    if (updates[key] === null) continue;
    
    var colIndex = headers.indexOf(key);
    if (colIndex !== -1) {
      sheet.getRange(targetRowIndex, colIndex + 1).setValue(updates[key]);
    }
  }
  
  Logger.log('ç™ºæ³¨æ›´æ–°æˆåŠŸ: ' + payload.po_id);
  
  return { success: true };
}

/**
 * POSTãƒãƒ³ãƒ‰ãƒ©ï¼ˆç™ºæ³¨æ›´æ–°ï¼‰
 */
function handleUpdateOrder_(payload) {
  return json_(updateOrder_(payload));
}
```

#### 2.6 ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´API
**ãƒ•ã‚¡ã‚¤ãƒ«**: `apps/gas/src/handlers/orders.js`

```javascript
/**
 * ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´
 * @param {Object} payload
 */
function changeOrderStatus_(payload) {
  if (!payload.po_id) throw new Error('po_idã¯å¿…é ˆã§ã™');
  if (!payload.newStatus) throw new Error('newStatusã¯å¿…é ˆã§ã™');
  
  // ç¾åœ¨ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å–å¾—
  var order = getOrderById_(payload.po_id);
  if (!order) throw new Error('ç™ºæ³¨ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: ' + payload.po_id);
  
  var currentStatus = order.status;
  var newStatus = payload.newStatus;
  
  // é·ç§»å¯èƒ½ã‹ãƒã‚§ãƒƒã‚¯
  var allowedTransitions = CONFIG.STATUS_TRANSITIONS[currentStatus] || [];
  if (allowedTransitions.indexOf(newStatus) === -1) {
    throw new Error('ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹é·ç§»ä¸å¯: ' + currentStatus + ' â†’ ' + newStatus);
  }
  
  // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°
  var sheet = openOrdersSheet_();
  var data = sheet.getDataRange().getValues();
  var headers = data[0];
  
  var poIdColIndex = headers.indexOf('po_id');
  var statusColIndex = headers.indexOf('ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹');
  var updatedByColIndex = headers.indexOf('last_updated_by');
  var updatedAtColIndex = headers.indexOf('last_updated_at');
  
  for (var i = 1; i < data.length; i++) {
    if (String(data[i][poIdColIndex]) === payload.po_id) {
      var rowIndex = i + 1;
      sheet.getRange(rowIndex, statusColIndex + 1).setValue(newStatus);
      sheet.getRange(rowIndex, updatedByColIndex + 1).setValue(payload.updatedBy || '');
      sheet.getRange(rowIndex, updatedAtColIndex + 1).setValue(new Date());
      break;
    }
  }
  
  Logger.log('ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´æˆåŠŸ: ' + payload.po_id + ' (' + currentStatus + ' â†’ ' + newStatus + ')');
  
  return { success: true };
}

/**
 * POSTãƒãƒ³ãƒ‰ãƒ©ï¼ˆã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´ï¼‰
 */
function handleChangeStatus_(payload) {
  return json_(changeOrderStatus_(payload));
}
```

### ãƒ†ã‚¹ãƒˆå†…å®¹
1. cURLã¾ãŸã¯Postmanã§ç™ºæ³¨ä½œæˆAPIã‚’ãƒ†ã‚¹ãƒˆ
2. ç™ºæ³¨ä¸€è¦§å–å¾—ã§ãƒ‡ãƒ¼ã‚¿ãŒè¿”å´ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
3. ç™ºæ³¨æ›´æ–°ãƒ»ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´ãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª

### å®Œäº†æ¡ä»¶
âœ… ç™ºæ³¨ä½œæˆAPIãŒå‹•ä½œã—ã€ã‚·ãƒ¼ãƒˆã«æ­£ã—ããƒ‡ãƒ¼ã‚¿ãŒè¿½åŠ ã•ã‚Œã‚‹  
âœ… ç™ºæ³¨ä¸€è¦§å–å¾—ã§ãƒ•ã‚£ãƒ«ã‚¿ãŒæ­£å¸¸ã«æ©Ÿèƒ½ã™ã‚‹  
âœ… ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹é·ç§»ã®æ¤œè¨¼ãŒæ­£ã—ãè¡Œã‚ã‚Œã‚‹

---

## Phase 3: GASãƒ¡ãƒ¼ãƒ«é€ä¿¡APIå®Ÿè£… ğŸŸ¡ é‡è¦

**ç›®çš„**: ä¾é ¼ãƒ¡ãƒ¼ãƒ«ãƒ»ç´å“å®Œäº†ãƒ¡ãƒ¼ãƒ«ã®é€ä¿¡æ©Ÿèƒ½ã‚’å®Ÿè£…

### ä½œæ¥­å†…å®¹

#### 3.1 ãƒ¡ãƒ¼ãƒ«ãƒãƒ³ãƒ‰ãƒ©å®Ÿè£…
**ãƒ•ã‚¡ã‚¤ãƒ«**: `apps/gas/src/handlers/mail.js`ï¼ˆæ–°è¦ï¼‰

```javascript
/**
 * ä¾é ¼ãƒ¡ãƒ¼ãƒ«é€ä¿¡ï¼ˆbefreeå®›ï¼‰
 * @param {Object} payload { poIds: string[] }
 */
function sendRequestEmail_(payload) {
  if (!payload.poIds || payload.poIds.length === 0) {
    throw new Error('é€ä¿¡å¯¾è±¡ã®ç™ºæ³¨IDãŒæŒ‡å®šã•ã‚Œã¦ã„ã¾ã›ã‚“');
  }
  
  // å¯¾è±¡ç™ºæ³¨ã‚’å–å¾—ï¼ˆsup_ä¾é ¼ä¸­ã®ã¿ï¼‰
  var orders = getOrders_({ statuses: ['sup_ä¾é ¼ä¸­'] });
  var targetOrders = orders.filter(function(o) {
    return payload.poIds.indexOf(o.po_id) >= 0;
  });
  
  if (targetOrders.length === 0) {
    throw new Error('é€ä¿¡å¯¾è±¡ã®ç™ºæ³¨ãŒã‚ã‚Šã¾ã›ã‚“ï¼ˆã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: sup_ä¾é ¼ä¸­ï¼‰');
  }
  
  // ãƒ¡ãƒ¼ãƒ«æœ¬æ–‡ç”Ÿæˆ
  var subject = 'ã€ç™ºæ³¨ä¾é ¼ã€‘Suprole - ' + today_() + ' (' + targetOrders.length + 'ä»¶)';
  var htmlBody = buildRequestEmailHtml_(targetOrders);
  
  // é€ä¿¡
  MailApp.sendEmail({
    to: CONFIG.MAIL.BEFREE,
    subject: subject,
    htmlBody: htmlBody
  });
  
  Logger.log('ä¾é ¼ãƒ¡ãƒ¼ãƒ«é€ä¿¡: ' + targetOrders.length + 'ä»¶');
  
  return { success: true, sentCount: targetOrders.length };
}

/**
 * ç´å“å®Œäº†ãƒ¡ãƒ¼ãƒ«é€ä¿¡ï¼ˆSuproleå®›ï¼‰
 * @param {Object} payload { poIds: string[] }
 */
function sendDeliveryEmail_(payload) {
  if (!payload.poIds || payload.poIds.length === 0) {
    throw new Error('é€ä¿¡å¯¾è±¡ã®ç™ºæ³¨IDãŒæŒ‡å®šã•ã‚Œã¦ã„ã¾ã›ã‚“');
  }
  
  // å¯¾è±¡ç™ºæ³¨ã‚’å–å¾—ï¼ˆbe_ç´å“æ‰‹ç¶šå®Œäº†ã®ã¿ï¼‰
  var orders = getOrders_({ statuses: ['be_ç´å“æ‰‹ç¶šå®Œäº†'] });
  var targetOrders = orders.filter(function(o) {
    return payload.poIds.indexOf(o.po_id) >= 0;
  });
  
  if (targetOrders.length === 0) {
    throw new Error('é€ä¿¡å¯¾è±¡ã®ç™ºæ³¨ãŒã‚ã‚Šã¾ã›ã‚“ï¼ˆã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: be_ç´å“æ‰‹ç¶šå®Œäº†ï¼‰');
  }
  
  // ãƒ¡ãƒ¼ãƒ«æœ¬æ–‡ç”Ÿæˆ
  var subject = 'ã€ç´å“æ‰‹ç¶šå®Œäº†ã€‘befree - ' + today_() + ' (' + targetOrders.length + 'ä»¶)';
  var htmlBody = buildDeliveryEmailHtml_(targetOrders);
  
  // é€ä¿¡
  MailApp.sendEmail({
    to: CONFIG.MAIL.SUPROLE,
    subject: subject,
    htmlBody: htmlBody
  });
  
  Logger.log('ç´å“å®Œäº†ãƒ¡ãƒ¼ãƒ«é€ä¿¡: ' + targetOrders.length + 'ä»¶');
  
  return { success: true, sentCount: targetOrders.length };
}

/**
 * ä¾é ¼ãƒ¡ãƒ¼ãƒ«HTMLç”Ÿæˆ
 */
function buildRequestEmailHtml_(orders) {
  var html = '<html><body style="font-family: sans-serif;">';
  html += '<h2>ç™ºæ³¨ä¾é ¼</h2>';
  html += '<p>ä»¥ä¸‹ã®å•†å“ã«ã¤ã„ã¦ç™ºæ³¨ã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚</p>';
  html += '<table border="1" cellpadding="5" cellspacing="0" style="border-collapse: collapse;">';
  html += '<tr style="background-color: #f0f0f0;">';
  html += '<th>ç™ºæ³¨ID</th><th>ASIN</th><th>å•†å“ã‚³ãƒ¼ãƒ‰</th><th>å•†å“å</th>';
  html += '<th>æ•°é‡ï¼ˆå€‹ï¼‰</th><th>å˜ä¾¡</th><th>åˆè¨ˆé¡</th><th>ç™ºæ³¨æ—¥</th>';
  html += '</tr>';
  
  var totalQuantity = 0;
  var totalAmount = 0;
  
  orders.forEach(function(o) {
    html += '<tr>';
    html += '<td>' + o.po_id + '</td>';
    html += '<td>' + o.asin + '</td>';
    html += '<td>' + o.productCode + '</td>';
    html += '<td>' + o.productName + '</td>';
    html += '<td style="text-align: right;">' + o.quantity + '</td>';
    html += '<td style="text-align: right;">Â¥' + o.unitPrice.toLocaleString() + '</td>';
    html += '<td style="text-align: right;">Â¥' + o.subtotal.toLocaleString() + '</td>';
    html += '<td>' + o.orderDate + '</td>';
    html += '</tr>';
    
    totalQuantity += o.quantity;
    totalAmount += o.subtotal;
  });
  
  html += '</table>';
  html += '<p><strong>ç™ºæ³¨ä»¶æ•°: ' + orders.length + 'ä»¶</strong></p>';
  html += '<p><strong>åˆè¨ˆç™ºæ³¨æ•°: ' + totalQuantity + 'å€‹</strong></p>';
  html += '<p><strong>åˆè¨ˆç™ºæ³¨é¡: Â¥' + totalAmount.toLocaleString() + 'ï¼ˆç¨æŠœï¼‰</strong></p>';
  html += '</body></html>';
  
  return html;
}

/**
 * ç´å“å®Œäº†ãƒ¡ãƒ¼ãƒ«HTMLç”Ÿæˆ
 */
function buildDeliveryEmailHtml_(orders) {
  var html = '<html><body style="font-family: sans-serif;">';
  html += '<h2>ç´å“æ‰‹ç¶šå®Œäº†é€šçŸ¥</h2>';
  html += '<p>ä»¥ä¸‹ã®å•†å“ã«ã¤ã„ã¦ç´å“æ‰‹ç¶šããŒå®Œäº†ã—ã¾ã—ãŸã€‚</p>';
  html += '<table border="1" cellpadding="5" cellspacing="0" style="border-collapse: collapse;">';
  html += '<tr style="background-color: #f0f0f0;">';
  html += '<th>ç™ºæ³¨ID</th><th>ASIN</th><th>å•†å“ã‚³ãƒ¼ãƒ‰</th><th>å•†å“å</th>';
  html += '<th>æ•°é‡ï¼ˆå€‹ï¼‰</th><th>å˜ä¾¡</th><th>åˆè¨ˆé¡</th>';
  html += '<th>æ¶ˆè²»ç¨ç‡</th><th>ä¼ç¥¨No.</th><th>åˆ°ç€äºˆå®šæ—¥</th>';
  html += '</tr>';
  
  var totalQuantity = 0;
  var totalSubtotal = 0;
  var totalTax = 0;
  
  orders.forEach(function(o) {
    var tax = o.subtotal * o.taxRate;
    var taxRatePct = (o.taxRate * 100).toFixed(0) + '%';
    
    html += '<tr>';
    html += '<td>' + o.po_id + '</td>';
    html += '<td>' + o.asin + '</td>';
    html += '<td>' + o.productCode + '</td>';
    html += '<td>' + o.productName + '</td>';
    html += '<td style="text-align: right;">' + o.quantity + '</td>';
    html += '<td style="text-align: right;">Â¥' + o.unitPrice.toLocaleString() + '</td>';
    html += '<td style="text-align: right;">Â¥' + o.subtotal.toLocaleString() + '</td>';
    html += '<td style="text-align: center;">' + taxRatePct + '</td>';
    html += '<td>' + o.invoiceNo + '</td>';
    html += '<td>' + o.arrivalDate + '</td>';
    html += '</tr>';
    
    totalQuantity += o.quantity;
    totalSubtotal += o.subtotal;
    totalTax += tax;
  });
  
  var totalWithTax = totalSubtotal + totalTax;
  
  html += '</table>';
  html += '<p><strong>ç™ºæ³¨ä»¶æ•°: ' + orders.length + 'ä»¶</strong></p>';
  html += '<p><strong>åˆè¨ˆæ•°é‡: ' + totalQuantity + 'å€‹</strong></p>';
  html += '<p><strong>ç¨æŠœåˆè¨ˆ: Â¥' + totalSubtotal.toLocaleString() + '</strong></p>';
  html += '<p><strong>æ¶ˆè²»ç¨: Â¥' + Math.round(totalTax).toLocaleString() + '</strong></p>';
  html += '<p><strong>ç¨è¾¼åˆè¨ˆ: Â¥' + Math.round(totalWithTax).toLocaleString() + '</strong></p>';
  html += '</body></html>';
  
  return html;
}

/**
 * POSTãƒãƒ³ãƒ‰ãƒ©ï¼ˆä¾é ¼ãƒ¡ãƒ¼ãƒ«ï¼‰
 */
function handleSendRequestEmail_(payload) {
  return json_(sendRequestEmail_(payload));
}

/**
 * POSTãƒãƒ³ãƒ‰ãƒ©ï¼ˆç´å“å®Œäº†ãƒ¡ãƒ¼ãƒ«ï¼‰
 */
function handleSendDeliveryEmail_(payload) {
  return json_(sendDeliveryEmail_(payload));
}
```

### ãƒ†ã‚¹ãƒˆå†…å®¹
1. ãƒ†ã‚¹ãƒˆç”¨ã®ç™ºæ³¨ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆ
2. ä¾é ¼ãƒ¡ãƒ¼ãƒ«é€ä¿¡APIã‚’å®Ÿè¡Œã—ã€ãƒ¡ãƒ¼ãƒ«ãŒå±Šãã“ã¨ã‚’ç¢ºèª
3. ç´å“å®Œäº†ãƒ¡ãƒ¼ãƒ«é€ä¿¡APIã‚’å®Ÿè¡Œã—ã€ãƒ¡ãƒ¼ãƒ«ãŒå±Šãã“ã¨ã‚’ç¢ºèª

### å®Œäº†æ¡ä»¶
âœ… ãƒ¡ãƒ¼ãƒ«ãŒæ­£ã—ã„å®›å…ˆã«é€ä¿¡ã•ã‚Œã‚‹  
âœ… HTMLå½¢å¼ã®æœ¬æ–‡ãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œã‚‹  
âœ… é›†è¨ˆå€¤ï¼ˆä»¶æ•°ãƒ»æ•°é‡ãƒ»é‡‘é¡ï¼‰ãŒæ­£ç¢º

---

## Phase 4: GASãƒã‚¹ã‚¿æ¤œç´¢APIæ‹¡å¼µ ğŸŸ¡ é‡è¦

**ç›®çš„**: å•†å“æ¤œç´¢ãƒ»ãƒã‚¹ã‚¿çµåˆãƒ“ãƒ¥ãƒ¼å–å¾—æ©Ÿèƒ½ã‚’å®Ÿè£…

### ä½œæ¥­å†…å®¹

#### 4.1 å•†å“æ¤œç´¢API
**ãƒ•ã‚¡ã‚¤ãƒ«**: `apps/gas/src/handlers/products.js`ï¼ˆæ–°è¦ï¼‰

```javascript
/**
 * å•†å“æ¤œç´¢ï¼ˆç™ºæ³¨ä½œæˆç”¨ï¼‰
 * @param {Object} filters { asin?, productCode?, namePart?, sku? }
 * @return {Array<Object>}
 */
function searchProducts_(filters) {
  filters = filters || {};
  
  // å•†å“ãƒã‚¹ã‚¿å–å¾—
  var productSheet = openProductMasterSheet_();
  var products = readSheetAsObjects_(productSheet);
  
  // ä»•å…¥ã‚Œãƒã‚¹ã‚¿å–å¾—
  var purchaseSheet = openPurchaseMasterSheet_();
  var purchases = readSheetAsObjects_(purchaseSheet);
  var purchaseMap = {};
  purchases.forEach(function(p) {
    purchaseMap[String(p.ASIN)] = p;
  });
  
  // ãƒ•ã‚£ãƒ«ã‚¿é©ç”¨
  var results = products.filter(function(p) {
    // è¡¨ç¤º/éè¡¨ç¤ºãƒã‚§ãƒƒã‚¯
    if (p['è¡¨ç¤º/éè¡¨ç¤º'] !== true && p['è¡¨ç¤º/éè¡¨ç¤º'] !== 'TRUE') return false;
    
    if (filters.sku && String(p.SKU) !== filters.sku) return false;
    if (filters.asin && String(p.ASIN) !== filters.asin) return false;
    if (filters.productCode && String(p['å•†å“ã‚³ãƒ¼ãƒ‰']) !== filters.productCode) return false;
    if (filters.namePart) {
      var keyword = String(filters.namePart).toLowerCase();
      var name = String(p['å•†å“å'] || '').toLowerCase();
      if (name.indexOf(keyword) === -1) return false;
    }
    
    return true;
  });
  
  // ä»•å…¥ã‚Œãƒã‚¹ã‚¿ã¨çµåˆ
  results = results.map(function(p) {
    var asin = String(p.ASIN);
    var purchase = purchaseMap[asin] || {};
    
    return {
      sku: String(p.SKU || ''),
      asin: asin,
      productCode: String(p['å•†å“ã‚³ãƒ¼ãƒ‰'] || ''),
      name: String(p['å•†å“å'] || ''),
      brand: String(p['ãƒ–ãƒ©ãƒ³ãƒ‰'] || ''),
      setSize: num_(purchase['ã‚»ãƒƒãƒˆå€‹æ•°']) || 1,
      minLot: num_(purchase['æœ€å°ãƒ­ãƒƒãƒˆ']) || 1,
      purchasePrice: num_(purchase['ä»•å…¥ã‚Œå€¤ï¼ˆç¨æŠœ/ã‚»ãƒƒãƒˆï¼‰']) || 0,
      hazard: purchase['å±é™ºç‰©'] === true || purchase['å±é™ºç‰©'] === 'TRUE',
      hasExpiry: purchase['æ¶ˆè²»æœŸé™è¦'] === true || purchase['æ¶ˆè²»æœŸé™è¦'] === 'TRUE'
    };
  });
  
  return results;
}

/**
 * GETãƒãƒ³ãƒ‰ãƒ©ï¼ˆå•†å“æ¤œç´¢ï¼‰
 */
function handleSearchProducts_(e) {
  var p = e.parameter || {};
  var filters = {
    sku: p.sku,
    asin: p.asin,
    productCode: p.productCode,
    namePart: p.q || p.namePart
  };
  
  var results = searchProducts_(filters);
  
  return json_({ items: results });
}
```

#### 4.2 ãƒã‚¹ã‚¿çµåˆãƒ“ãƒ¥ãƒ¼
**ãƒ•ã‚¡ã‚¤ãƒ«**: `apps/gas/src/handlers/products.js`

```javascript
/**
 * ãƒã‚¹ã‚¿çµåˆãƒ“ãƒ¥ãƒ¼å–å¾—
 */
function getMasterView_(filters) {
  return searchProducts_(filters); // åŒã˜ãƒ­ã‚¸ãƒƒã‚¯ã‚’ä½¿ç”¨
}

/**
 * GETãƒãƒ³ãƒ‰ãƒ©ï¼ˆãƒã‚¹ã‚¿çµåˆãƒ“ãƒ¥ãƒ¼ï¼‰
 */
function handleGetMasterView_(e) {
  return handleSearchProducts_(e);
}
```

#### 4.3 Code.jsã¸ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è¿½åŠ 
**ãƒ•ã‚¡ã‚¤ãƒ«**: `apps/gas/src/Code.js`

```javascript
function doGet(e) {
  try {
    guard_(e);
    var p = (e && e.parameter && e.parameter.path) ? String(e.parameter.path).toLowerCase() : 'dashboard';
    
    // æ—¢å­˜ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
    if (p === 'dashboard') return handleDashboard_(e);
    if (p === 'products')  return handleProducts_(e);
    if (p === 'product')   return handleProductBySku_(e);
    if (p === 'alerts')    return handleAlerts_(e);
    
    // ç™ºæ³¨ç®¡ç†ç”¨ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è¿½åŠ 
    if (p === 'orders') return handleGetOrders_(e);
    if (p === 'searchproducts') return handleSearchProducts_(e);
    if (p === 'masterview') return handleGetMasterView_(e);
    
    return json_({ error: 'not found' }, 404);
  } catch (err) {
    return json_({ error: String(err) }, 500);
  }
}
```

### ãƒ†ã‚¹ãƒˆå†…å®¹
1. å•†å“æ¤œç´¢APIã§éƒ¨åˆ†ä¸€è‡´æ¤œç´¢ãŒå‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª
2. ä»•å…¥ã‚Œãƒã‚¹ã‚¿ã¨ã®çµåˆãƒ‡ãƒ¼ã‚¿ãŒæ­£ã—ãè¿”å´ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª

### å®Œäº†æ¡ä»¶
âœ… å•†å“æ¤œç´¢ã§è¤‡æ•°æ¡ä»¶ã®ãƒ•ã‚£ãƒ«ã‚¿ãŒæ©Ÿèƒ½ã™ã‚‹  
âœ… ä»•å…¥ã‚Œãƒã‚¹ã‚¿ã®æƒ…å ±ãŒæ­£ã—ãçµåˆã•ã‚Œã‚‹

---

## Phase 5: Next.jsã‚µãƒ¼ãƒãƒ«ãƒ¼ãƒˆå®Ÿè£… ğŸŸ¡ é‡è¦

**ç›®çš„**: GAS APIã‚’ãƒ—ãƒ­ã‚­ã‚·ã™ã‚‹Next.jsã‚µãƒ¼ãƒãƒ«ãƒ¼ãƒˆã‚’å®Ÿè£…

### ä½œæ¥­å†…å®¹

#### 5.1 ç™ºæ³¨ä¸€è¦§ãƒ»è©³ç´°å–å¾—
**ãƒ•ã‚¡ã‚¤ãƒ«**: `apps/web/app/api/gas/orders/route.ts`ï¼ˆæ–°è¦ï¼‰

```typescript
import { NextRequest, NextResponse } from 'next/server';

export async function GET(req: NextRequest) {
  const base = process.env.GAS_API_BASE!;
  const key = process.env.GAS_API_KEY!;

  const searchParams = req.nextUrl.searchParams;
  
  const url = new URL(base);
  url.searchParams.set('path', 'orders');
  url.searchParams.set('key', key);
  
  // ãƒ•ã‚£ãƒ«ã‚¿ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è»¢é€
  ['po_id', 'statuses', 'sku', 'asin', 'seller', 'productName', 'fromDate', 'toDate'].forEach(param => {
    const value = searchParams.get(param);
    if (value) url.searchParams.set(param, value);
  });

  try {
    const res = await fetch(url.toString(), { cache: 'no-store' });
    const data = await res.json();
    
    if (data._status && data._status >= 400) {
      return NextResponse.json(data, { status: data._status });
    }
    
    return NextResponse.json(data);
  } catch (error) {
    return NextResponse.json(
      { error: 'Failed to fetch orders' },
      { status: 500 }
    );
  }
}
```

#### 5.2 ç™ºæ³¨ä½œæˆ
**ãƒ•ã‚¡ã‚¤ãƒ«**: `apps/web/app/api/gas/orders/route.ts`

```typescript
// åŒã˜ãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½åŠ 
export async function POST(req: NextRequest) {
  const base = process.env.GAS_API_BASE!;
  const key = process.env.GAS_API_KEY!;

  const url = new URL(base);
  url.searchParams.set('action', 'createOrder');
  url.searchParams.set('key', key);

  try {
    const payload = await req.json();
    
    const res = await fetch(url.toString(), {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(payload),
    });
    
    const data = await res.json();
    
    if (data._status && data._status >= 400) {
      return NextResponse.json(data, { status: data._status });
    }
    
    // æˆåŠŸæ™‚ã¯ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
    // revalidatePath('/orders');
    
    return NextResponse.json(data);
  } catch (error) {
    return NextResponse.json(
      { error: 'Failed to create order' },
      { status: 500 }
    );
  }
}
```

#### 5.3 ç™ºæ³¨è©³ç´°å–å¾—
**ãƒ•ã‚¡ã‚¤ãƒ«**: `apps/web/app/api/gas/orders/[poId]/route.ts`ï¼ˆæ–°è¦ï¼‰

```typescript
import { NextRequest, NextResponse } from 'next/server';

export async function GET(
  req: NextRequest,
  { params }: { params: { poId: string } }
) {
  const base = process.env.GAS_API_BASE!;
  const key = process.env.GAS_API_KEY!;

  const url = new URL(base);
  url.searchParams.set('path', 'orders');
  url.searchParams.set('key', key);
  url.searchParams.set('po_id', params.poId);

  try {
    const res = await fetch(url.toString(), { cache: 'no-store' });
    const data = await res.json();
    
    if (data.items && data.items.length > 0) {
      return NextResponse.json(data.items[0]);
    }
    
    return NextResponse.json({ error: 'Order not found' }, { status: 404 });
  } catch (error) {
    return NextResponse.json(
      { error: 'Failed to fetch order' },
      { status: 500 }
    );
  }
}
```

#### 5.4 ç™ºæ³¨æ›´æ–°
**ãƒ•ã‚¡ã‚¤ãƒ«**: `apps/web/app/api/gas/orders/[poId]/route.ts`

```typescript
// åŒã˜ãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½åŠ 
export async function PUT(
  req: NextRequest,
  { params }: { params: { poId: string } }
) {
  const base = process.env.GAS_API_BASE!;
  const key = process.env.GAS_API_KEY!;

  const url = new URL(base);
  url.searchParams.set('action', 'updateOrder');
  url.searchParams.set('key', key);

  try {
    const payload = await req.json();
    payload.po_id = params.poId;
    
    const res = await fetch(url.toString(), {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(payload),
    });
    
    const data = await res.json();
    
    if (data._status && data._status >= 400) {
      return NextResponse.json(data, { status: data._status });
    }
    
    return NextResponse.json(data);
  } catch (error) {
    return NextResponse.json(
      { error: 'Failed to update order' },
      { status: 500 }
    );
  }
}
```

#### 5.5 ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´
**ãƒ•ã‚¡ã‚¤ãƒ«**: `apps/web/app/api/gas/orders/[poId]/status/route.ts`ï¼ˆæ–°è¦ï¼‰

```typescript
import { NextRequest, NextResponse } from 'next/server';

export async function PUT(
  req: NextRequest,
  { params }: { params: { poId: string } }
) {
  const base = process.env.GAS_API_BASE!;
  const key = process.env.GAS_API_KEY!;

  const url = new URL(base);
  url.searchParams.set('action', 'changeStatus');
  url.searchParams.set('key', key);

  try {
    const payload = await req.json();
    payload.po_id = params.poId;
    
    const res = await fetch(url.toString(), {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(payload),
    });
    
    const data = await res.json();
    
    if (data._status && data._status >= 400) {
      return NextResponse.json(data, { status: data._status });
    }
    
    return NextResponse.json(data);
  } catch (error) {
    return NextResponse.json(
      { error: 'Failed to change status' },
      { status: 500 }
    );
  }
}
```

#### 5.6 ãƒ¡ãƒ¼ãƒ«é€ä¿¡
**ãƒ•ã‚¡ã‚¤ãƒ«**: `apps/web/app/api/gas/orders/mail/route.ts`ï¼ˆæ–°è¦ï¼‰

```typescript
import { NextRequest, NextResponse } from 'next/server';

export async function POST(req: NextRequest) {
  const base = process.env.GAS_API_BASE!;
  const key = process.env.GAS_API_KEY!;

  try {
    const { type, poIds } = await req.json();
    
    if (!['request', 'delivery'].includes(type)) {
      return NextResponse.json(
        { error: 'Invalid mail type' },
        { status: 400 }
      );
    }
    
    const action = type === 'request' ? 'sendRequestEmail' : 'sendDeliveryEmail';
    
    const url = new URL(base);
    url.searchParams.set('action', action);
    url.searchParams.set('key', key);
    
    const res = await fetch(url.toString(), {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ poIds }),
    });
    
    const data = await res.json();
    
    if (data._status && data._status >= 400) {
      return NextResponse.json(data, { status: data._status });
    }
    
    return NextResponse.json(data);
  } catch (error) {
    return NextResponse.json(
      { error: 'Failed to send email' },
      { status: 500 }
    );
  }
}
```

#### 5.7 å•†å“æ¤œç´¢
**ãƒ•ã‚¡ã‚¤ãƒ«**: `apps/web/app/api/gas/products/search/route.ts`ï¼ˆæ–°è¦ï¼‰

```typescript
import { NextRequest, NextResponse } from 'next/server';

export async function GET(req: NextRequest) {
  const base = process.env.GAS_API_BASE!;
  const key = process.env.GAS_API_KEY!;

  const searchParams = req.nextUrl.searchParams;
  
  const url = new URL(base);
  url.searchParams.set('path', 'searchproducts');
  url.searchParams.set('key', key);
  
  // æ¤œç´¢ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è»¢é€
  ['sku', 'asin', 'productCode', 'q'].forEach(param => {
    const value = searchParams.get(param);
    if (value) url.searchParams.set(param, value);
  });

  try {
    const res = await fetch(url.toString(), { cache: 'no-store' });
    const data = await res.json();
    
    return NextResponse.json(data);
  } catch (error) {
    return NextResponse.json(
      { error: 'Failed to search products' },
      { status: 500 }
    );
  }
}
```

#### 5.8 ãƒã‚¹ã‚¿ãƒ“ãƒ¥ãƒ¼
**ãƒ•ã‚¡ã‚¤ãƒ«**: `apps/web/app/api/gas/masters/route.ts`ï¼ˆæ–°è¦ï¼‰

```typescript
import { NextRequest, NextResponse } from 'next/server';

export async function GET(req: NextRequest) {
  const base = process.env.GAS_API_BASE!;
  const key = process.env.GAS_API_KEY!;

  const searchParams = req.nextUrl.searchParams;
  
  const url = new URL(base);
  url.searchParams.set('path', 'masterview');
  url.searchParams.set('key', key);
  
  // æ¤œç´¢ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è»¢é€
  ['sku', 'asin', 'productCode', 'q'].forEach(param => {
    const value = searchParams.get(param);
    if (value) url.searchParams.set(param, value);
  });

  try {
    const res = await fetch(url.toString(), { cache: 'no-store' });
    const data = await res.json();
    
    return NextResponse.json(data);
  } catch (error) {
    return NextResponse.json(
      { error: 'Failed to fetch masters' },
      { status: 500 }
    );
  }
}
```

### ãƒ†ã‚¹ãƒˆå†…å®¹
1. å„APIãƒ«ãƒ¼ãƒˆãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª
2. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒé©åˆ‡ã«è¡Œã‚ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª

### å®Œäº†æ¡ä»¶
âœ… å…¨APIãƒ«ãƒ¼ãƒˆãŒå®Ÿè£…ã•ã‚Œã€GASã¸ã®ãƒ—ãƒ­ã‚­ã‚·ãŒå‹•ä½œã™ã‚‹  
âœ… ã‚¨ãƒ©ãƒ¼æ™‚ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒé©åˆ‡

---

## Phase 6: å‹å®šç¾©ã¨ã‚¹ã‚­ãƒ¼ãƒæ•´å‚™ ğŸŸ¡ é‡è¦

**ç›®çš„**: TypeScriptå‹å®šç¾©ã‚’è¿½åŠ ã—ã€å‹å®‰å…¨æ€§ã‚’ç¢ºä¿

### ä½œæ¥­å†…å®¹

#### 6.1 å‹å®šç¾©è¿½åŠ 
**ãƒ•ã‚¡ã‚¤ãƒ«**: `apps/web/lib/types.ts`

```typescript
// æ—¢å­˜ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½åŠ 

// Order types
export type OrderStatus =
  | 'sup_ä¾é ¼ä¸­'
  | 'be_ãƒ¡ãƒ¼ã‚«ãƒ¼å–å¯„ä¸­'
  | 'be_ç´å“æ‰‹ç¶šå®Œäº†'
  | 'sup_å—å–å®Œäº†'
  | 'sup_fbaå‡ºè·å®Œäº†'
  | 'ä¿ç•™'
  | 'è¿”å“';

export type Order = {
  po_id: string;
  sku: string;
  asin: string;
  productCode: string;
  productName: string;
  orderDate: string; // YYYY-MM-DD
  seller: string;
  quantity: number;
  setCount: number;
  setSize: number;
  unitPrice: number;
  subtotal: number;
  taxRate: number;
  invoiceNo: string;
  arrivalDate: string | null;
  status: OrderStatus;
  remarks: string;
  createdBy: string;
  createdAt: string;
  lastUpdatedBy: string;
  lastUpdatedAt: string;
};

export type OrdersResponse = { items: Order[]; total: number } | ApiError;

export type CreateOrderInput = {
  sku: string;
  setCount: number;
  taxRate?: number;
  seller?: string;
  orderDate?: string;
  remarks?: string;
  createdBy: string;
};

export type UpdateOrderInput = {
  taxRate?: number;
  invoiceNo?: string;
  arrivalDate?: string;
  remarks?: string;
  updatedBy: string;
};

export type ChangeStatusInput = {
  newStatus: OrderStatus;
  updatedBy: string;
};

export type SendMailInput = {
  type: 'request' | 'delivery';
  poIds: string[];
};

// Product search types
export type ProductSearchResult = {
  sku: string;
  asin: string;
  productCode: string;
  name: string;
  brand: string;
  setSize: number;
  minLot: number;
  purchasePrice: number;
  hazard: boolean;
  hasExpiry: boolean;
};

export type ProductSearchResponse = { items: ProductSearchResult[] } | ApiError;

// Master view types
export type MasterItem = ProductSearchResult; // åŒã˜æ§‹é€ 
export type MasterViewResponse = { items: MasterItem[] } | ApiError;
```

### å®Œäº†æ¡ä»¶
âœ… å‹å®šç¾©ãŒè¿½åŠ ã•ã‚Œã€å‹ã‚¨ãƒ©ãƒ¼ãŒãªã„

---

## Phase 7-9: UIå®Ÿè£…

ï¼ˆè©³ç´°ã¯é•·ããªã‚‹ãŸã‚ã€åˆ¥é€”æŒ‡ç¤ºã§å±•é–‹ã—ã¾ã™ï¼‰

### Phase 7: ç™ºæ³¨ä¸€è¦§ãƒšãƒ¼ã‚¸ï¼ˆ/ordersï¼‰
- ãƒ•ã‚£ãƒ«ã‚¿ãƒ»ã‚½ãƒ¼ãƒˆãƒ»ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³
- è¡Œé¸æŠãƒ»ä¸€æ‹¬æ“ä½œ
- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´
- ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ«

### Phase 8: æ–°è¦ç™ºæ³¨ä½œæˆãƒšãƒ¼ã‚¸ï¼ˆ/orders/createï¼‰
- å•†å“æ¤œç´¢
- ã‚»ãƒƒãƒˆæ•°å…¥åŠ›ãƒ»è¨ˆç®—
- ç¢ºèªãƒ»ä½œæˆ

### Phase 9: ãƒã‚¹ã‚¿é–²è¦§ãƒšãƒ¼ã‚¸ï¼ˆ/mastersï¼‰
- å•†å“ãƒ»ä»•å…¥ã‚Œãƒã‚¹ã‚¿ã®çµåˆãƒ“ãƒ¥ãƒ¼
- æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿

---

## Phase 10: çµ±åˆãƒ»ãƒ†ã‚¹ãƒˆãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤ ğŸŸ¢ ä»•ä¸Šã’

### ä½œæ¥­å†…å®¹
1. E2Eãƒ†ã‚¹ãƒˆå®Ÿæ–½
2. æ¨©é™ãƒ†ã‚¹ãƒˆï¼ˆallowlistï¼‰
3. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ
4. ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™
5. ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆdev â†’ prodï¼‰

---

## ğŸ“Š é€²æ—ç®¡ç†

å„ãƒ•ã‚§ãƒ¼ã‚ºå®Œäº†æ™‚ã«ãƒã‚§ãƒƒã‚¯ï¼š

```
â–¡ Phase 1: GASåŸºç›¤æ•´å‚™
â–¡ Phase 2: GASç™ºæ³¨CRUD API
â–¡ Phase 3: GASãƒ¡ãƒ¼ãƒ«é€ä¿¡API
â–¡ Phase 4: GASãƒã‚¹ã‚¿æ¤œç´¢APIæ‹¡å¼µ
â–¡ Phase 5: Next.jsã‚µãƒ¼ãƒãƒ«ãƒ¼ãƒˆ
â–¡ Phase 6: å‹å®šç¾©ã¨ã‚¹ã‚­ãƒ¼ãƒ
â–¡ Phase 7: UI - ç™ºæ³¨ä¸€è¦§
â–¡ Phase 8: UI - æ–°è¦ç™ºæ³¨ä½œæˆ
â–¡ Phase 9: UI - ãƒã‚¹ã‚¿é–²è¦§
â–¡ Phase 10: çµ±åˆãƒ»ãƒ†ã‚¹ãƒˆãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤
```

---

## ğŸ¯ æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³

**æ¨å¥¨**: Phase 1ã‹ã‚‰é †æ¬¡å®Ÿè£…ã‚’é–‹å§‹ã—ã¦ãã ã•ã„ã€‚

å„ãƒ•ã‚§ãƒ¼ã‚ºå®Œäº†å¾Œã€å‹•ä½œç¢ºèªã¨ãƒ†ã‚¹ãƒˆã‚’è¡Œã„ã€æ¬¡ã®ãƒ•ã‚§ãƒ¼ã‚ºã«é€²ã¿ã¾ã™ã€‚
å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆã¯ã€ãã®éƒ½åº¦èª¿æ•´ã—ã¾ã™ã€‚

å®Ÿè£…ã‚’é–‹å§‹ã™ã‚‹æº–å‚™ã¯ã§ãã¦ã„ã¾ã™ã‹ï¼Ÿã©ã®ãƒ•ã‚§ãƒ¼ã‚ºã‹ã‚‰ç€æ‰‹ã—ã¾ã™ã‹ï¼Ÿ

