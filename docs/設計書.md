
---

# 📘 Amazon Seller 管理UI 設計書（v2 完全版）

---

## 0. 概要

**目的**
Excelをデータソースとして、Amazonセラー運営者が「売上・在庫・パフォーマンス・状態・発注予測」を**一目で閲覧・分析**できるWeb UIを構築する。
重点は**閲覧特化（非編集）・視認性・移動のしやすさ・データ粒度の切替**である。

**主要シート**

1. 日次売上集計
2. 商品別売上集計
3. 商品別日次売上集計
4. 商品別カート取得率集計
5. 商品別在庫日次集計
6. 全体在庫日次集計
7. 商品マスタ
8. 商品状態（※推奨発注数・需要予測含む）

---

## 1. サイトマップ構造

```
/dashboard                ... 全体ダッシュボード（売上・在庫・需要総覧）
/products                 ... 商品一覧（主要KPIと状態サマリ）
/products/{SKU}           ... 商品詳細（時系列推移・予測・発注判断）
/alerts                   ... アラート・発注推奨一覧
```

ナビゲーション原則：

* `/dashboard` → `/products` はカテゴリ・SKUクリックで1クリック遷移。
* パンくず構造：Dashboard ＞ Products ＞ SKU詳細。
* 一覧上で📌ピン留め→ダッシュボードで上位固定表示。

---

## 2. 各ページ詳細設計

### 🧭 `/dashboard`（全体ダッシュボード）

#### レイアウト

* ヘッダー：

  * 期間切替（日/週/月）
  * 日付範囲選択カレンダー
  * 検索バー（ASIN / SKU / 商品名）

#### KPIカード（横並び）

| 指標          | 取得元シート   | 列名              | 算出方法         |
| ----------- | -------- | --------------- | ------------ |
| 期間総売上（税抜）   | 日次売上集計   | 実質売上            | 期間合計         |
| 注文件数        | 日次売上集計   | 注文件数            | 合計           |
| 出荷商品数       | 日次売上集計   | 出荷商品数           | 合計           |
| 平均注文単価(AOV) | 日次売上集計   | 実質売上 / 注文件数     | 平均           |
| 加重平均カート率    | カート取得率日次 | カート取得率%, セッション数 | 加重平均         |
| 現在在庫合計      | 全体在庫日次集計 | 在庫数             | 期間末日時点       |
| 総推奨発注数      | 商品状態     | 推奨発注数           | ∑推奨発注数（全SKU） |
| 総需要予測       | 商品状態     | 需要予測            | ∑需要予測（全SKU）  |

#### グラフ

1. **売上推移（棒） + カート率（折れ線） + 在庫量（副軸棒）**

   * 売上金額：日次売上集計.実質売上
   * カート率：カート取得率日次.カート取得率%
   * 在庫量：全体在庫日次集計.在庫数
2. **カテゴリ別売上構成（ドーナツ）**

   * 商品マスタ.カテゴリ × 商品別日次売上集計.実質売上
3. **発注必要SKU数（棒）**

   * 商品状態.推奨発注数 > 0 のSKU件数

#### 下部リスト

* トップ売上SKU（期間合計上位10）
* 発注推奨SKU（推奨発注数降順）
* 需要急増SKU（需要予測増加率上位）

---

### 📦 `/products`（商品一覧）

#### 表構造

| 列          | シート       | 列名              | 説明         |
| ---------- | --------- | --------------- | ---------- |
| 商品名 / カテゴリ | 商品マスタ     | 商品名, カテゴリ       | クリックで詳細へ   |
| SKU / ASIN | 商品マスタ     | SKU, ASIN       | 主キー        |
| 売上数量 / 金額  | 商品別日次売上集計 | 販売数量, 実質売上      | 期間合計       |
| 平均カート率     | カート取得率日次  | カート取得率%, セッション数 | 加重平均       |
| 現在在庫数      | 商品別在庫日次集計 | 在庫数             | 末日時点       |
| 在庫日数(DOH)  | 同上 + 売上   | 在庫数 / 平均日販      | 算出         |
| 状態         | 商品状態      | 在庫健全性           | 色バッジ       |
| 推奨発注数      | 商品状態      | 推奨発注数           | 需要予測基準に生成  |
| 需要予測       | 商品状態      | 需要予測            | 翌期見込数量     |
| アラート       | 商品状態      | アラート種別          | 発注/在庫/売上など |

#### 並び替え・フィルタ

* 並び替え：売上, 在庫日数, カート率, 推奨発注数
* フィルタ：カテゴリ, 状態, 在庫リスク, 発注推奨有無

---

### 🔍 `/products/{SKU}`（商品詳細）

#### 上部ヘッダー

* 商品名 / SKU / ASIN / カテゴリ（商品マスタ）
* 在庫健全性 / 状態（商品状態）
* 📈推奨発注数・📊需要予測（バッジ表示）

#### KPIミニカード

| 指標     | シート       | 列               | 算出                   |
| ------ | --------- | --------------- | -------------------- |
| 売上金額   | 商品別日次売上集計 | 実質売上            | 期間合計                 |
| 販売数量   | 商品別日次売上集計 | 販売数量            | 期間合計                 |
| 平均カート率 | カート取得率日次  | カート取得率%, セッション数 | 加重平均                 |
| 在庫数    | 商品別在庫日次集計 | 在庫数             | 末日                   |
| DOH    | 同上 + 売上   | 在庫数 / 平均日販      | 算出                   |
| 推奨発注数  | 商品状態      | 推奨発注数           | 需要予測基準               |
| 需要予測   | 商品状態      | 需要予測            | 直近30日平均×季節係数（UI内算出可） |

#### チャート構成

1. **売上推移**（棒）

   * x軸：売上日
   * y軸：実質売上
2. **販売数量推移**（折れ線）

   * 同日軸で数量表示
3. **カート取得率推移**（副軸折れ線）

   * カート取得率日次.カート取得率%
4. **在庫推移**（棒）

   * 商品別在庫日次集計.在庫数
5. **需要予測 vs 発注数（棒+線）**

   * 商品状態.需要予測と推奨発注数を比較
   * 棒＝需要予測、線＝発注数目安

#### テーブル詳細

| 日付                             | 売上数量 | 売上金額 | カート率% | 在庫数 | 需要予測 | 推奨発注数 |
| ------------------------------ | ---- | ---- | ----- | --- | ---- | ----- |
| 商品別日次売上集計 + 商品別在庫日次集計 + 商品状態結合 |      |      |       |     |      |       |

---

### 🚨 `/alerts`（アラート/発注提案）

#### ルールセット

| ルール    | 判定条件             | 深刻度      | ソース   |
| ------ | ---------------- | -------- | ----- |
| 在庫切れ予測 | DOH ≤ 7          | Critical | 在庫・売上 |
| カート率急落 | 7日MA差分 ≤ -10pt   | Warning  | カート率  |
| 連続売上ゼロ | 連続7日 販売数量=0      | Warning  | 売上    |
| 在庫過多   | DOH ≥ 90         | Info     | 在庫    |
| 状態異常   | 在庫健全性 ∈ {停止, 注意} | Critical | 商品状態  |
| 発注必要   | 推奨発注数 > 0        | Action   | 商品状態  |
| 需要急増   | 需要予測 > 前期×1.3    | Notice   | 商品状態  |

#### 表構成

| SKU | 商品名 | アラート内容 | 深刻度 | 推奨発注数 | 在庫数 | DOH | 需要予測 | 最終更新 |
| --- | --- | ------ | --- | ----- | --- | --- | ---- | ---- |

---

## 3. データ統合モデル

### ファクト・ディメンション設計

```
fact_sales_daily
 ├─ SKU
 ├─ 日付（売上日）
 ├─ 販売数量
 ├─ 実質売上
 ├─ カート率（ASIN変換後）
 ├─ 在庫数（JOIN後）
 ├─ 推奨発注数（JOIN後）
 ├─ 需要予測（JOIN後）
 ├─ 状態（JOIN後）
 └─ カテゴリ・商品名（dim_product）
```

JOINキー：

* SKU基準
* ASIN列は`商品マスタ`でSKU⇔ASIN紐づけ
* 商品状態の`SKU`で左外部結合

---

## 4. KPI算出式一覧

| 指標        | 定義式                     | ソース       |
| --------- | ----------------------- | --------- |
| 売上金額      | ∑実質売上                   | 商品別日次売上集計 |
| 販売数量      | ∑販売数量                   | 同上        |
| 平均カート率    | ∑(カート率%×セッション数)/∑セッション数 | カート取得率日次  |
| 平均日販      | ∑販売数量/期間日数              | 売上        |
| 在庫日数(DOH) | 最新在庫数 / 平均日販            | 在庫+売上     |
| 推奨発注数     | 商品状態.推奨発注数              | シート値      |
| 需要予測      | 商品状態.需要予測               | シート値      |
| 在庫切れ日     | 現在在庫 / 平均日販 → 端数切上げ日数   | 算出        |

---

## 5. 色・可視化ルール

| 状態             | 色           | アイコン |
| -------------- | ----------- | ---- |
| カート率高          | 緑 (#10B981) | 🛒   |
| カート率中          | 橙 (#F59E0B) | ⚠️   |
| カート率低          | 赤 (#EF4444) | ❌    |
| 在庫余裕（DOH>60）   | 緑           | 📦   |
| 在庫注意（DOH15–59） | 橙           | 🕒   |
| 在庫危険（DOH<15）   | 赤           | 🚨   |
| 推奨発注あり         | 青 (#3B82F6) | 📈   |
| 需要急増           | 紫 (#8B5CF6) | 🔥   |

---

## 6. インタラクション仕様

* **日/週/月 切替**：全グラフ同期更新
* **クリックドリルダウン**：ダッシュボードランキング→商品詳細へ
* **ピン留め**：SKU単位でローカル保存
* **範囲ズーム**：日次グラフをドラッグ拡大
* **アラート連携**：アラートクリック→対象SKU詳細に遷移

---

## 7. 技術仕様（実装メモ）

* **バックエンド**：FastAPI + pandas

  * Excel読込→正規化→`fact_sales_daily`生成
  * JSON REST APIでReact側へ供給
* **フロントエンド**：React + Tailwind + shadcn/ui + Recharts

  * KPIカード・グラフ・テーブル共通設計
* **キャッシュ方針**：

  * Excel更新日ごとにキャッシュクリア
  * ダッシュボードのみ pre-aggregate

---

## 8. 実装ステップ（推奨順）

1. Excel→`fact_sales_daily`統合スクリプト構築（SKU軸・ASIN結合含む）
2. `/dashboard` MVP構築（KPI + グラフ + ランキング）
3. `/products` テーブル構築 + カテゴリ/状態フィルタ
4. `/products/{SKU}` 詳細ページ（推奨発注数・需要予測チャート含む）
5. `/alerts` 自動判定ロジック導入（閾値変更UIは後日）

---

